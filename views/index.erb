<html>
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
		<script type ="text/javascript">

			colors = ["red",  "blue", "green"];
			$(document).ready(function(){
				getKeys();
			});

			function getKeys(){
				$.getJSON('/keys', function(data){
					$("#keys").html("");
					var count=0;
					for (key in data){
						count+=1;
						var col = colors[Math.floor(data[key].ttl*3.0/90.0)] || "black";
						$("#keys").append($("<li> "+ key +" time left  "+data[key].ttl+" s </li>" ).css("color", col));

					}
					$("#count").html(count);

					setTimeout(getKeys, 100);
				});
			}

		</script>
	</head>
	<body>
		<h1>Telescope Status <%=@status%></h1>
		<img src="http://top-people.starmedia.com/tmp/swotti/cacheZNJHBMSGEMFWCGE=UGVVCGXLLVBLB3BSZQ==/imgFrank%20Zappa3.jpg" style="position:absolute; top:10px; right:10px"
		<p>Frank is currently observering tartget <%=@observation_id%> and has the following  <span id="count"></span> keys: </p>

		<ul id="keys" style="list-format='none'">
			<% @keys.each do |key| %>
				<li> <%=key%> </li>
			<%end%>
		</ul>
	</body>
</html>